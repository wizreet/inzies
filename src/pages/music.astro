---
/**
 * Music Page
 *
 * Displays all releases and streaming platform links.
 * Uses centralized data from the releases module.
 */
import { Icon } from "astro-icon/components";
import MainLayout from "../layouts/MainLayout.astro";
import ReleaseCard from "../components/music/ReleaseCard.astro";
import { getReleasesSortedByDate } from "../data/releases";
import { siteConfig } from "../config";
import { PLATFORM_COLORS } from "../constants";

// Get releases sorted by date (newest first)
const sortedReleases = getReleasesSortedByDate("desc");

// Streaming platforms configuration with proper security attributes
const streamingPlatforms = [
	{
		name: "Spotify",
		url: siteConfig.social.spotify ?? "#",
		color: PLATFORM_COLORS.SPOTIFY,
		hoverClass: "hover:bg-green-600/20 hover:border-green-500",
		icon: "fa6-brands:spotify",
	},
	{
		name: "YouTube",
		url: siteConfig.social.youtube ?? "#",
		color: PLATFORM_COLORS.YOUTUBE,
		hoverClass: "hover:bg-red-600/20 hover:border-red-500",
		icon: "fa6-brands:youtube",
	},
] as const;
---

<MainLayout title="Music" description="Our releases and where to stream them.">
	<!-- Header -->
	<div class="mb-16">
		<h1 class="section-title mb-6 text-4xl md:text-5xl">Music</h1>
		<p class="text-xl text-[var(--text-secondary)]">Our releases</p>
	</div>

	<!-- Releases -->
	<section class="mb-20" aria-labelledby="releases-heading">
		<h2
			id="releases-heading"
			class="mb-8 border-b border-[var(--border-color)] pb-4 text-2xl font-bold"
		>
			Releases
		</h2>
		<div class="grid grid-cols-1 gap-8 md:grid-cols-2">
			{
				sortedReleases.map((release, index) => (
					<div class="scroll-reveal" style={`animation-delay: ${index * 0.1}s`}>
						<ReleaseCard release={release} />
					</div>
				))
			}
		</div>
	</section>

	<!-- Streaming Platforms -->
	<section aria-labelledby="streaming-heading">
		<h2
			id="streaming-heading"
			class="mb-8 border-b border-[var(--border-color)] pb-4 text-2xl font-bold"
		>
			Listen Anywhere
		</h2>
		<div class="grid grid-cols-2 gap-4 md:grid-cols-4">
			{
				streamingPlatforms.map((platform) => (
					<a
						href={platform.url}
						target="_blank"
						rel="noopener noreferrer"
						class:list={[
							"card-base group flex items-center justify-center gap-3 p-6 transition-all",
							platform.hoverClass,
						]}
						aria-label={`Listen on ${platform.name} (opens in new tab)`}
					>
						<Icon name={platform.icon} class="h-8 w-8" style={`color: ${platform.color}`} />
						<span class="font-medium">{platform.name}</span>
					</a>
				))
			}
		</div>
	</section>
</MainLayout>
